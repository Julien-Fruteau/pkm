{"pageProps":{"note":{"id":"cheed1pahe44d690evqkilq","title":"Pytest","desc":"","updated":1656966208685,"created":1654269525911,"custom":{},"fname":"python.pytest","type":"note","vault":{"fsPath":"vault"},"contentHash":"5ee7caa3db3f54c06fbf141fa3b11667","links":[{"from":{"fname":"python","vaultName":"vault"},"type":"backlink","position":{"start":{"line":6,"column":1,"offset":41},"end":{"line":6,"column":18,"offset":58},"indent":[]},"value":"python.pytest","alias":"python.pytest"}],"anchors":{"pytest-mock":{"type":"header","text":"pytest-mock","value":"pytest-mock","line":8,"column":0,"depth":2},"mock-object-method":{"type":"header","text":"Mock object method","value":"mock-object-method","line":14,"column":0,"depth":3},"mock-module-function":{"type":"header","text":"Mock module function","value":"mock-module-function","line":36,"column":0,"depth":3}},"children":[],"parent":"ENDcCZFjAW9h66eDoFg7I","data":{}},"body":"<h1 id=\"pytest\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#pytest\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Pytest</h1>\n<h2 id=\"pytest-mock\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#pytest-mock\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>pytest-mock</h2>\n<p>Context : #<a href=\"\">python</a> #<a href=\"\">test</a> #<a href=\"\">pytest</a> #<a href=\"\">mock</a> #<a href=\"\">pytest-mock</a></p>\n<p>A usage example of the <code>pytest_mock</code> module</p>\n<h3 id=\"mock-object-method\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#mock-object-method\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Mock object method</h3>\n<pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pytest_mock <span class=\"token keyword\">import</span> MockerFixture\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">echo</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        fmt_text <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span>upper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> fmt_text\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">test_foo</span><span class=\"token punctuation\">(</span>mocker<span class=\"token punctuation\">:</span> MockerFixture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    a <span class=\"token operator\">=</span> A<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    mocker<span class=\"token punctuation\">.</span>patch<span class=\"token punctuation\">.</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token string\">'echo'</span><span class=\"token punctuation\">,</span> return_value<span class=\"token operator\">=</span><span class=\"token string\">\"MOCKED\"</span><span class=\"token punctuation\">,</span> autospec<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">assert</span> a<span class=\"token punctuation\">.</span>echo<span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"MOCKED\"</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">test_foo_no_mock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    a <span class=\"token operator\">=</span> A<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">assert</span> a<span class=\"token punctuation\">.</span>echo<span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"HELLO\"</span>\n</code></pre>\n<h3 id=\"mock-module-function\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#mock-module-function\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Mock module function</h3>\n<ul>\n<li>my_package.my_module file :</li>\n</ul>\n<pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">my_function_to_mock</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> text<span class=\"token punctuation\">.</span>capitalize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">function_using_function_to_mock</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    use<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> my_function_to_mock<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> use <span class=\"token operator\">+</span> <span class=\"token string\">\" Function\"</span>\n</code></pre>\n<ul>\n<li>testing :</li>\n</ul>\n<pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pytest_mock <span class=\"token keyword\">import</span> MockerFixture\n<span class=\"token keyword\">from</span> my_package<span class=\"token punctuation\">.</span>my_module <span class=\"token keyword\">import</span> function_using_function_to_mock\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">test_function_using_function_to_mock</span><span class=\"token punctuation\">(</span>mocker<span class=\"token punctuation\">:</span> MockerFixture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mocker<span class=\"token punctuation\">.</span>patch<span class=\"token punctuation\">(</span><span class=\"token string\">\"my_package.my_module.my_function_to_mock\"</span><span class=\"token punctuation\">,</span> return_value<span class=\"token operator\">=</span><span class=\"token string\">\"MOCKED\"</span><span class=\"token punctuation\">)</span>\n    actual <span class=\"token operator\">=</span> function_using_function_to_mock<span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">assert</span> actual <span class=\"token operator\">==</span> <span class=\"token string\">\"MOCKED Function\"</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">test_function_without_mocking</span><span class=\"token punctuation\">(</span>mocker<span class=\"token punctuation\">:</span> MockerFixture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    actual <span class=\"token operator\">=</span> function_using_function_to_mock<span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">assert</span> actual <span class=\"token operator\">==</span> <span class=\"token string\">\"Hello Function\"</span>\n\n</code></pre>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/pkm/notes/ENDcCZFjAW9h66eDoFg7I\">Python</a></li>\n</ul>","noteIndex":{"id":"wn8PE1RhG0znK1alrGFYv","title":"Root","desc":"","updated":1654269246697,"created":1631901573363,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"95c106dfdcb097574cc5e3b9ac850f05","links":[],"anchors":{"welcome-to-the-knowledge-management-website":{"type":"header","text":"Welcome to the knowledge management website","value":"welcome-to-the-knowledge-management-website","line":7,"column":0,"depth":2}},"children":["ENDcCZFjAW9h66eDoFg7I"],"parent":null,"data":{},"body":"## Welcome to the knowledge management website\n\nLast updated:\n- version: v0.83\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"dendronVersion":"0.83.0","enableEditorDecorations":true,"enableHandlebarTemplates":false,"enableFullHierarchyNoteTitle":false,"templateHierarchy":"template","seeds":{"dendron.templates":{},"dendron.handbook":{"site":{"url":"https://handbook.dendron.so","index":"handbook"}}}},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"enableSiteLastModified":true,"siteRootDir":"docs","siteUrl":"https://julien-fruteau.github.io","assetsPrefix":"/pkm","enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"writeStubs":false,"seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enablePrettyLinks":true,"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}